import{_ as g,c as p,b as a,a as c,t as n,w as _,F as m,f as r,g as o,r as l,o as f,j as v,p as k,k as w}from"./index-DIAUPzm1.js";const d=e=>(k("data-v-f33a60ea"),e=e(),w(),e),b={class:"about"},x={class:"info"},y={class:"touxiang"},S=["src"],A={class:"name"},B={class:"shejiao"},C=d(()=>a("div",null,null,-1)),F=d(()=>a("br",null,null,-1)),V={data(){return{userid:"",setname:"设置",setcount:3,setshow:0,id:1,name:"未登录",avatar:"//xiey.work/ava.png",mail:"",signature:"这个人很懒，什么都没写。",access_token:"",refresh_token:"",avatarFile:null,url:"",showavatarpage:0,previewImage:null,file:null}},methods:{modavatarpage(){this.showavatarpage=!this.showavatarpage,console.log(this.showavatarpage)},onFileChange(e){const t=e.target.files[0];if(this.file=t,t){const s=new FileReader;s.onload=i=>{this.previewImage=i.target.result},s.readAsDataURL(t)}},putavatar(e){if(!e){this.warm=1;return}if(!e.type.startsWith("image/")){alert("请选择图片文件");return}if(e.size>4*1024*1024){alert("图片大小不能超过4MB");return}var t=new Date,s=t.getSeconds();console.log(s),r.put(this.url+"/bocchi/user/avatar/upload",{avatar_file:e},{headers:{"Content-Type":"multipart/form-data","access-token":this.access_token,Accept:"*/*"}}).then(i=>{console.log(i),this.avatar=i.data.user.avatar+"?"+s,this.modavatarpage(),this.warm=1}).catch(i=>{console.error(i)})},settings(){this.setshow=!this.setshow,this.setcount++},refreshtoken(){r.get(this.url+"/bocchi/access_token/get",{headers:{"refresh-token":this.refresh_token,Accept:"*/*"}}).then(e=>{console.log(e),console.log(e.data.access_token),this.access_token=e.data.access_token,o.remove("access_token"),this.cookiesSet=o.set("access_token",e.data.access_token,{expires:1})}).catch(e=>{console.error(e)})},logout(){o.remove("id"),o.remove("access_token"),o.remove("refresh_token"),window.location.href="/"},init(){r.get(this.url+"/bocchi/user/info?user_id="+this.id).then(e=>{console.log(e),e.data.base.code=="10000"&&(console.log("获取信息成功"),this.name=e.data.user.name,this.avatar=e.data.user.avatar,this.mail=e.data.user.email,this.signature=e.data.user.signature),e.data.base.code=="10007"&&(console.log("不存在"),this.name="该用户不存在"),console.log(this.avatar),this.avatar===""&&(this.avatar="//xiey.work/ava.png"),this.signature===""&&(this.signature="这个人很懒，什么都没写。")}).catch(e=>{console.error(e)})}},mounted(){this.id=o.get("id"),this.access_token=o.get("access_token"),this.refresh_token=o.get("refresh_token"),String(this.$route.params.id)=="undefined"?(this.id=o.get("id"),this.init()):(this.id=Number(this.$route.params.id),this.init())},components:{},computed:{},watch:{setcount(e){e%2==1&&(this.setname="设置"),e%2!=1&&(this.setname="关闭")}},props:{},emits:{},setup(){}},j=Object.assign(V,{__name:"AboutView",setup(e){return(t,s)=>{const i=l("a-page-header"),h=l("a-divider");return f(),p(m,null,[a("div",b,[c(i,{style:{border:"1px solid rgb(235, 237, 240)","background-color":"#fff"},title:"Ta的资料","sub-title":"",onBack:s[0]||(s[0]=()=>t.$router.go(-1))}),a("div",x,[a("div",y,[a("div",null,[a("img",{src:t.avatar,class:"touxiangimg rounded-image",onClick:s[1]||(s[1]=(...u)=>t.modavatarpage&&t.modavatarpage(...u)),style:{"object-fit":"cover"}},null,8,S),a("div",null,[a("text",A,n(t.name),1)])])]),a("div",B,[a("text",null,"uid:"+n(t.id),1),a("text",null,"邮箱:"+n(t.mail),1),a("text",null,"签名:"+n(t.signature),1)])]),C,c(h,{orientation:"left",class:"separate"},{default:_(()=>[v("评价")]),_:1})]),F],64)}}}),T=g(j,[["__scopeId","data-v-f33a60ea"]]);export{T as default};
