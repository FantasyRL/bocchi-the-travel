import{_ as f,r as c,o as k,c as _,a as e,b as l,t as n,d as p,w as g,T as w,e as d,v as h,f as b,F as C,g as u,h as i,p as F,i as S}from"./index-DeKft_st.js";const r=t=>(F("data-v-edfe4521"),t=t(),S(),t),y={class:"about"},A={class:"settings"},B=r(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",viewBox:"0 0 20 20",height:"20",fill:"none",class:"svg-icon"},[e("g",{"stroke-width":"1.5","stroke-linecap":"round",stroke:"#5d41de"},[e("circle",{r:"2.5",cy:"10",cx:"10"}),e("path",{"fill-rule":"evenodd",d:"m8.39079 2.80235c.53842-1.51424 2.67991-1.51424 3.21831-.00001.3392.95358 1.4284 1.40477 2.3425.97027 1.4514-.68995 2.9657.82427 2.2758 2.27575-.4345.91407.0166 2.00334.9702 2.34248 1.5143.53842 1.5143 2.67996 0 3.21836-.9536.3391-1.4047 1.4284-.9702 2.3425.6899 1.4514-.8244 2.9656-2.2758 2.2757-.9141-.4345-2.0033.0167-2.3425.9703-.5384 1.5142-2.67989 1.5142-3.21831 0-.33914-.9536-1.4284-1.4048-2.34247-.9703-1.45148.6899-2.96571-.8243-2.27575-2.2757.43449-.9141-.01669-2.0034-.97028-2.3425-1.51422-.5384-1.51422-2.67994.00001-3.21836.95358-.33914 1.40476-1.42841.97027-2.34248-.68996-1.45148.82427-2.9657 2.27575-2.27575.91407.4345 2.00333-.01669 2.34247-.97026z","clip-rule":"evenodd"})])],-1)),I={class:"lable"},V={class:"info"},D=["src"],N={class:"name"},T={class:"shejiao"},$=r(()=>e("div",null,null,-1)),j={class:"setpage"},z={blur:!0},E=r(()=>e("text",null,"设置界面",-1)),M={class:"setpage-flur"},O={class:"avatarpage"},q=r(()=>e("div",{class:"bg"},null,-1)),G={data(){return{userid:"",setname:"设置",setcount:3,setshow:0,id:1,name:"未登录",avatar:"//xiey.work/ava.png",mail:"",signature:"这个人很懒，什么都没写。",access_token:"",refresh_token:"",avatarFile:null,url:"",showavatarpage:0}},methods:{modavatarpage(){this.showavatarpage=!this.showavatarpage,console.log(this.showavatarpage)},onFileChange(t){this.avatarFile=t.target.files[0]},putavatar(){if(!this.avatarFile){alert("请选择一个文件");return}let t=new FormData;t.append("avatar",this.avatarFile),u.put(this.url+"/bocchi/user/avatar/upload",t,{headers:{"Content-Type":"multipart/form-data","access-token":this.access_token,Accept:"*/*"}}).then(s=>{console.log(s)}).catch(s=>{console.error(s)})},settings(){this.setshow=!this.setshow,this.setcount++},refreshtoken(){u.get(this.url+"/bocchi/access_token/get",{headers:{"refresh-token":this.refresh_token,Accept:"*/*"}}).then(t=>{console.log(t),console.log(t.data.access_token),this.access_token=t.data.access_token,i.remove("access_token"),this.cookiesSet=i.set("access_token",t.data.access_token,{expires:1})}).catch(t=>{console.error(t)})},logout(){i.remove("id"),i.remove("access_token"),i.remove("refresh_token"),window.location.href="/"},init(){u.get(this.url+"/bocchi/user/info?user_id="+this.id).then(t=>{console.log(t),t.data.base.code=="10000"&&(console.log("获取信息成功"),this.name=t.data.user.name,this.avatar=t.data.user.avatar,this.mail=t.data.user.email,this.signature=t.data.user.signature),t.data.base.code=="10007"&&(console.log("不存在"),this.name="该用户不存在"),console.log(this.avatar),this.avatar===""&&(this.avatar="//xiey.work/ava.png"),this.signature===""&&(this.signature="这个人很懒，什么都没写。")}).catch(t=>{console.error(t)})}},mounted(){this.id=i.get("id"),this.access_token=i.get("access_token"),this.refresh_token=i.get("refresh_token"),String(this.$route.params.id)=="undefined"?(this.id=i.get("id"),this.init()):(this.id=Number(this.$route.params.id),this.init())},components:{},computed:{},watch:{setcount(t,s){t%2==1&&(this.setname="设置"),t%2!=1&&(this.setname="关闭")}},props:{},emits:{},setup(){}},H=Object.assign(G,{__name:"AboutView",setup(t){return(s,a)=>{const v=c("a-page-header"),m=c("a-divider");return k(),_(C,null,[e("div",y,[l(v,{style:{border:"1px solid rgb(235, 237, 240)"},title:"个人中心","sub-title":"1",onBack:a[0]||(a[0]=()=>s.$router.go(-1))}),e("div",A,[e("button",{class:"button",onClick:a[1]||(a[1]=(...o)=>s.settings&&s.settings(...o))},[B,e("span",I,n(s.setname),1)])]),e("div",V,[e("div",{class:"touxiang",onClick:a[2]||(a[2]=(...o)=>s.modavatarpage&&s.modavatarpage(...o))},[e("div",null,[e("img",{src:s.avatar,class:"touxiangimg rounded-image"},null,8,D),e("div",null,[e("text",N,n(s.name),1)])])]),e("div",T,[p(n(String(s.$route.params.id))+" ",1),e("text",null,"uid:"+n(s.id),1),e("text",null,"邮箱:"+n(s.mail),1),e("text",null,"签名:"+n(s.signature),1)])]),$,l(w,{name:"fade"},{default:g(()=>[d(e("div",j,[e("mdui-list",z,[E,e("mdui-list-item",{onClick:a[3]||(a[3]=(...o)=>s.refreshtoken&&s.refreshtoken(...o))},"刷新令牌"),e("mdui-list-item",{onClick:a[4]||(a[4]=(...o)=>s.logout&&s.logout(...o))},"退出登陆")])],512),[[h,s.setshow]])]),_:1}),d(e("div",M,null,512),[[h,s.setshow]]),d(e("div",O,[e("form",{onSubmit:a[7]||(a[7]=b((...o)=>s.uploadAvatar&&s.uploadAvatar(...o),["prevent"]))},[e("input",{type:"file",ref:"avatarInput",onChange:a[5]||(a[5]=(...o)=>s.onFileChange&&s.onFileChange(...o))},null,544),e("button",{type:"submit",onClick:a[6]||(a[6]=(...o)=>s.putavatar&&s.putavatar(...o))},"上传头像")],32)],512),[[h,0]]),l(m,{orientation:"center",class:"separate"},{default:g(()=>[p("我的行程")]),_:1})]),q],64)}}}),K=f(H,[["__scopeId","data-v-edfe4521"]]);export{K as default};
