import{m as J,n as E,q as C,s as O,_ as V,x as P,l as y,c as L,b as r,a as g,w as Y,d as z,v as j,j as I,t as x,h as H,F as W,f as T,g as $,r as k,o as S,p as q,k as G}from"./index-NJmCkMPq.js";var Q={exports:{}};(function(i,_){(function(f,m){i.exports=m(J)})(E,function(f){function m(o){return o&&typeof o=="object"&&"default"in o?o:{default:o}}var M=m(f),a={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(o,n){return n==="W"?o+"周":o+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(o,n){var c=100*o+n;return c<600?"凌晨":c<900?"早上":c<1100?"上午":c<1300?"中午":c<1800?"下午":"晚上"}};return M.default.locale(a,null,!0),a})})(Q);const K={locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",yearFormat:"YYYY年",dayFormat:"D日",dateFormat:"YYYY年M月D日",dateTimeFormat:"YYYY年M月D日 HH时mm分ss秒",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪"},R={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]},B={lang:C({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},K),timePickerLocale:C({},R)};B.lang.ok="确定";var F={exports:{}};(function(i,_){(function(f,m){i.exports=m()})(E,function(){function f(e){var u=[];return e.AMapUI&&u.push(m(e.AMapUI)),e.Loca&&u.push(M(e.Loca)),Promise.all(u)}function m(e){return new Promise(function(u,t){var s=[];if(e.plugins)for(var d=0;d<e.plugins.length;d+=1)o.AMapUI.plugins.indexOf(e.plugins[d])==-1&&s.push(e.plugins[d]);if(n.AMapUI===a.failed)t("前次请求 AMapUI 失败");else if(n.AMapUI===a.notload){n.AMapUI=a.loading,o.AMapUI.version=e.version||o.AMapUI.version,d=o.AMapUI.version;var h=document.body||document.head,l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/ui/"+d+"/main.js",l.onerror=function(v){n.AMapUI=a.failed,t("请求 AMapUI 失败")},l.onload=function(){if(n.AMapUI=a.loaded,s.length)window.AMapUI.loadUI(s,function(){for(var v=0,b=s.length;v<b;v++){var U=s[v].split("/").slice(-1)[0];window.AMapUI[U]=arguments[v]}for(u();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()});else for(u();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()},h.appendChild(l)}else n.AMapUI===a.loaded?e.version&&e.version!==o.AMapUI.version?t("不允许多个版本 AMapUI 混用"):s.length?window.AMapUI.loadUI(s,function(){for(var v=0,b=s.length;v<b;v++){var U=s[v].split("/").slice(-1)[0];window.AMapUI[U]=arguments[v]}u()}):u():e.version&&e.version!==o.AMapUI.version?t("不允许多个版本 AMapUI 混用"):c.AMapUI.push(function(v){v?t(v):s.length?window.AMapUI.loadUI(s,function(){for(var b=0,U=s.length;b<U;b++){var N=s[b].split("/").slice(-1)[0];window.AMapUI[N]=arguments[b]}u()}):u()})})}function M(e){return new Promise(function(u,t){if(n.Loca===a.failed)t("前次请求 Loca 失败");else if(n.Loca===a.notload){n.Loca=a.loading,o.Loca.version=e.version||o.Loca.version;var s=o.Loca.version,d=o.AMap.version.startsWith("2"),h=s.startsWith("2");if(d&&!h||!d&&h)t("JSAPI 与 Loca 版本不对应！！");else{d=o.key,h=document.body||document.head;var l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/loca?v="+s+"&key="+d,l.onerror=function(v){n.Loca=a.failed,t("请求 AMapUI 失败")},l.onload=function(){for(n.Loca=a.loaded,u();c.Loca.length;)c.Loca.splice(0,1)[0]()},h.appendChild(l)}}else n.Loca===a.loaded?e.version&&e.version!==o.Loca.version?t("不允许多个版本 Loca 混用"):u():e.version&&e.version!==o.Loca.version?t("不允许多个版本 Loca 混用"):c.Loca.push(function(v){v?t(v):t()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var a;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(a||(a={}));var o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},n={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},c={AMap:[],AMapUI:[],Loca:[]},A=[],p=function(e){typeof e=="function"&&(n.AMap===a.loaded?e(window.AMap):A.push(e))};return{load:function(e){return new Promise(function(u,t){if(n.AMap==a.failed)t("");else if(n.AMap==a.notload){var s=e.key,d=e.version,h=e.plugins;s?(window.AMap&&location.host!=="lbs.amap.com"&&t("禁止多种API加载方式混用"),o.key=s,o.AMap.version=d||o.AMap.version,o.AMap.plugins=h||o.AMap.plugins,n.AMap=a.loading,d=document.body||document.head,window.___onAPILoaded=function(v){if(delete window.___onAPILoaded,v)n.AMap=a.failed,t(v);else for(n.AMap=a.loaded,f(e).then(function(){u(window.AMap)}).catch(t);A.length;)A.splice(0,1)[0]()},h=document.createElement("script"),h.type="text/javascript",h.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+o.AMap.version+"&key="+s+"&plugin="+o.AMap.plugins.join(","),h.onerror=function(v){n.AMap=a.failed,t(v)},d.appendChild(h)):t("请填写key")}else if(n.AMap==a.loaded)if(e.key&&e.key!==o.key)t("多个不一致的 key");else if(e.version&&e.version!==o.AMap.version)t("不允许多个版本 JSAPI 混用");else{if(s=[],e.plugins)for(d=0;d<e.plugins.length;d+=1)o.AMap.plugins.indexOf(e.plugins[d])==-1&&s.push(e.plugins[d]);s.length?window.AMap.plugin(s,function(){f(e).then(function(){u(window.AMap)}).catch(t)}):f(e).then(function(){u(window.AMap)}).catch(t)}else if(e.key&&e.key!==o.key)t("多个不一致的 key");else if(e.version&&e.version!==o.AMap.version)t("不允许多个版本 JSAPI 混用");else{var l=[];if(e.plugins)for(d=0;d<e.plugins.length;d+=1)o.AMap.plugins.indexOf(e.plugins[d])==-1&&l.push(e.plugins[d]);p(function(){l.length?window.AMap.plugin(l,function(){f(e).then(function(){u(window.AMap)}).catch(t)}):f(e).then(function(){u(window.AMap)}).catch(t)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,o={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},n={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},c={AMap:[],AMapUI:[],Loca:[]}}}})})(F);var X=F.exports;const D=O(X),w=i=>(q("data-v-f682cb9e"),i=i(),G(),i),Z={class:"create"},ee={class:"input-box"},oe={class:"input-box"},ae={key:0},te={class:""},ne={class:"input-box"},le={class:"input-box"},se={key:1},ie={class:"rectangle"},re={class:"nb"},ue=w(()=>r("p",null,"省份＋城市＋区县＋城镇＋乡村＋街道＋门牌号码",-1)),de=["src"],pe={class:"input-box"},ce={class:"input-box"},ve={class:"time-box"},fe=w(()=>r("br",null,null,-1)),me=w(()=>r("br",null,null,-1)),_e={class:"start-button"},he=w(()=>r("span",{class:"shadow"},null,-1)),ge=w(()=>r("span",{class:"edge"},null,-1)),Me=w(()=>r("span",{class:"front"}," 创建 ",-1)),Ae=[he,ge,Me],we=w(()=>r("br",null,null,-1)),be=w(()=>r("br",null,null,-1)),ye=w(()=>r("br",null,null,-1)),Ie=w(()=>r("br",null,null,-1)),Ye=w(()=>r("br",null,null,-1));P.locale("zh-cn");const ke={computed:{discountedPrice(i,_){return[{keyword:i},{keyword:_}]}},setup(){return{value:P("2015-01-01","YYYY-MM-DD"),dayjs:P,locale:B}},data(){return{img:null,trnumber:10,access_token:"",refresh_token:"",partyid:Number(this.$route.params.id),data:[],road:[],routejson:null,map:null,map2:null,resultjson:{}}},methods:{reremap(i){this.img="https://restapi.amap.com/v3/staticmap?zoom=15&size=250*250&key=eae4d0491385d75b43d247afaef4247d&location="+i,console.log(this.img)},rero(){this.map=new AMap.Map("roadmap",{viewMode:"3D",zoom:11,center:[116.397428,39.90923]})},remap(){this.map=new AMap.Map("rectangletmap",{viewMode:"2D",zoom:6,center:[116.397428,39.90923],map:null})},savero(i,_){const f=[{keyword:i},{keyword:_}];window._AMapSecurityConfig={securityJsCode:""},D.load({key:"",version:"2.0",plugins:["AMap.Scale"]}).then(m=>{let M=new m.Map("roadmap",{viewMode:"2D",zoom:18,center:[118.397428,39.90923]});m.plugin(["AMap.ToolBar","AMap.Driving","AMap.Polyline","AMap.Marker"],function(){var a=new m.ToolBar;M.addControl(a);var o=new m.Driving({map:M,panel:"panel"});o.search(f,function(n,c){n==="complete"?(console.log(c),console.log(c.routes)):console.log("获取驾车数据失败："+c)})})}).catch(m=>{console.log(m)})},savemap(i){T.get("https://restapi.amap.com/v3/geocode/geo?address="+i+"&key=4a456acf68e96cfd42e35d8915c9cee0").then(_=>{console.log(_),this.data=_.data.geocodes[0].location.split(","),this.reremap(this.data),this.map=new AMap.Map("rectangletmap",{viewMode:"2D",zoom:19,center:this.data,map:null})}).catch(_=>{console.error(_)})},partycreate(i,_,f,m,M,a,o,n){const c=n[0],p=new Date(c).toISOString().slice(0,50),e=n[1],t=new Date(e).toISOString().slice(0,50);console.log(t),T.post("/bocchi/party/itinerary/create?title="+i+"&action_type="+_+"&party_id="+f+"&rectangle="+m+"&route_json="+M+","+a+"&remark="+o+"&schedule_start_time="+p+"&schedule_end_time="+t,{},{headers:{"access-token":this.access_token}}).then(s=>{console.log(s.data),s.data.base.code==1e4&&(console.log("创建成功"),this.$router.go(-1))}).catch(s=>{console.log(s),alert("创建失败，请检查你的输入！")})}},mounted(){this.partyid=Number(this.$route.params.id),this.access_token=$.get("access_token"),this.refresh_token=$.get("refresh_token"),window._AMapSecurityConfig={securityJsCode:""},D.load({key:"",version:"2.0",plugins:["AMap.Scale"]}).then(i=>{this.map=new i.Map("rectangletmap",{viewMode:"2D",zoom:18,center:[116.397428,39.90923]})}).catch(i=>{console.log(i)}),D.load({key:"",version:"2.0",plugins:["AMap.Scale"]}).then(i=>{this.map2=new i.Map("roadmap",{viewMode:"2D",zoom:18,center:[116.397428,39.90923]})}).catch(i=>{console.log(i)})},computed:{getlocal(){return i=>{if(i==i)return"https://restapi.amap.com/v3/staticmap?zoom=17&size=250*250&key=eae4d0491385d75b43d247afaef4247d&location="+i}}},watch:{}},Ue=Object.assign(ke,{__name:"Createplan",setup(i){const _=y(""),f=y("1"),m=y(""),M=y(""),a=y(""),o=y(),n=y(),c=y([{value:"1",label:"路线"},{value:"2",label:"活动"},{value:"3",label:"住处"},{value:"4",label:"吃喝"},{value:"5",label:"其他"}]);return(A,p)=>{const e=k("a-page-header"),u=k("a-divider"),t=k("a-input"),s=k("a-select"),d=k("a-textarea"),h=k("a-range-picker");return S(),L(W,null,[r("div",null,[g(e,{style:{border:"1px solid rgb(235, 237, 240)"},title:"创建计划",onBack:p[0]||(p[0]=()=>A.$router.go(-1))})]),r("div",Z,[g(u,{orientation:"left",class:"separate"},{default:Y(()=>[I("计划名")]),_:1}),r("div",ee,[g(t,{value:_.value,"onUpdate:value":p[1]||(p[1]=l=>_.value=l),bordered:!1,size:"large",placeholder:"标题"},null,8,["value"])]),g(u,{orientation:"left",class:"separate"},{default:Y(()=>[I("活动类型")]),_:1}),r("div",oe,[g(s,{value:f.value,"onUpdate:value":p[2]||(p[2]=l=>f.value=l),size:"large",style:{width:"100%"},bordered:!1,placeholder:"请选择你的活动类型",options:c.value},null,8,["value","options"])]),z(g(u,{orientation:"left",class:"separate"},{default:Y(()=>[I("路线")]),_:1},512),[[j,!(f.value-1)]]),I(" "+x(M.value)+x(a.value)+" ",1),f.value-1?H("",!0):(S(),L("div",ae,[r("div",te,[I(x(A.roadroad)+" ",1),r("div",ne,[g(t,{value:M.value,"onUpdate:value":p[3]||(p[3]=l=>M.value=l),bordered:!1,size:"large",placeholder:"出发点(系统会提供路径地图)"},null,8,["value"])]),r("div",le,[g(t,{value:a.value,"onUpdate:value":p[4]||(p[4]=l=>a.value=l),bordered:!1,size:"large",placeholder:"结束点"},null,8,["value"])])])])),z(g(u,{orientation:"left",class:"separate"},{default:Y(()=>[I("地点")]),_:1},512),[[j,f.value-1]]),f.value-1?(S(),L("div",se,[r("div",ie,[r("div",re,[ue,r("img",{src:this.img},null,8,de)]),r("div",pe,[g(t,{value:o.value,"onUpdate:value":p[5]||(p[5]=l=>o.value=l),bordered:!1,size:"large",placeholder:"输入地点保存后可获取参考地图(可选)"},null,8,["value"])]),r("button",{onClick:p[6]||(p[6]=l=>A.reremap(this.data))},"刷新地图"),r("button",{onClick:p[7]||(p[7]=l=>A.savemap(o.value))},"保存地点")])])):H("",!0),g(u,{orientation:"left",class:"separate"},{default:Y(()=>[I("备注")]),_:1}),r("div",ce,[g(d,{value:n.value,"onUpdate:value":p[8]||(p[8]=l=>n.value=l),placeholder:"备注",rows:4,size:"large",bordered:!1},null,8,["value"])]),g(u,{orientation:"left",class:"separate"},{default:Y(()=>[I("起止时间")]),_:1}),r("div",ve,[g(h,{value:m.value,"onUpdate:value":p[9]||(p[9]=l=>m.value=l),size:"large",bordered:!1,"show-time":{format:"HH:mm"}},null,8,["value"])]),fe,me,r("div",_e,[r("button",{class:"pushable",onClick:p[10]||(p[10]=l=>A.partycreate(_.value,f.value,A.partyid,this.data,M.value,a.value,n.value,m.value))},Ae)])]),we,be,ye,Ie,Ye],64)}}}),xe=V(Ue,[["__scopeId","data-v-f682cb9e"]]);export{xe as default};
